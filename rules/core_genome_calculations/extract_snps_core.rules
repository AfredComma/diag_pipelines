rule extract_snps_core:
    conda:
        "env/vcftools.yaml"
    input:
        "core/Mycobacterium_tuberculosis/{ref}_core_sorted.bed",
        "mapping/snippy/{ref}/{sample}/snps.vcf.gz"
    output:
        "strains/{sample}/core/{ref}/snps.vcf.gz"
    shell:
        """
        tabix -f -h -R {input[0]} {input[1]} | vcf-sort | bgzip > {output[0]}
        tabix -f -p vcf {output[0]}
        """


    
