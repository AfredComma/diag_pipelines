rule align_paired_reads_to_assembled_genome:
    conda:
        "env/bwa.yaml"
    input:
        "strains/{sample}/annotation/{sample}.fsa",
        "reads/raw/{sample}_R1.fastq.gz",
        "reads/raw/{sample}_R2.fastq.gz"
    output:
        temp("strains/{sample}/mapping/{sample}.bam")
    shell:
        """
        bwa index {input[0]}
        bwa mem -v 1 {input} | samtools sort -O BAM -o {output} - 
        """

rule align_single_reads_to_assembled_genome:
    conda:
        "env/bwa.yaml"
    input:
        "strains/{sample}/annotation/{sample}.fsa",
        "reads/raw/{sample}_single.fastq.gz"
    output:
        temp("strains/{sample}/mapping/{sample}.bam")
    shell:
        """
        bwa index {input[0]}
        bwa mem -v 1 {input} | samtools sort -O BAM -o {output} -
        """
