rule qualimap_mapping_to_reference:
    conda:
        "../../envs/qualimap.yaml"
    input:
        "samples/{sample}/mapping/bwa/{ref}/{sample}.bam",
    output:
        "samples/{sample}/quality/mapping/bwa/{ref}/qualimap/qualimapReport.html",
        "samples/{sample}/quality/mapping/bwa/{ref}/qualimap/genome_results.txt",
        "samples/{sample}/quality/mapping/bwa/{ref}/qualimap/raw_data_qualimapReport/coverage_histogram.txt",
    log:
        logging_folder+"/samples/{sample}/logs/mapping/bwa/{ref}/qualimap.txt"
    shell:
        """
        qualimap bamqc -bam {input[0]} -outdir $(dirname {output}) > {log[0]}
        """
    
