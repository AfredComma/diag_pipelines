rule qualimap_mapping_to_reference:
    conda:
        "env/qualimap.yaml"
    input:
        "strains/{sample}/mapping/bwa/{ref}/{sample}/snps_deduplicated.bam",
    output:
        "strains/{sample}/quality/mapping/bwa/{ref}/qualimap/qualimapReport.html",
        "strains/{sample}/quality/mapping/bwa/{ref}/qualimap/genome_results.txt",
        "strains/{sample}/quality/mapping/bwa/{ref}/qualimap/raw_data_qualimapReport/coverage_histogram.txt",
        
    shell:
        """
        qualimap bamqc -bam {input[0]} -outdir $(dirname {output})
        """
    
