rule mlst_samples:
    conda:
        "env/mlst.yaml"
    input:
        expand("strains/{sample}/annotation/{sample}.fsa", sample=read_naming.keys())
    output:
        "typing/mlst/summary.out"
    shell:
        """
        mlst {input} | sed "s/.*\///" | sed "s/\.fsa//"  > {output[0]}
        """

rule mlst_all_complete_genomes_fasta:
    conda:
        "env/mlst.yaml"
    input:
        "references/all_complete_genomes_log.txt"
    output:
        "typing/mlst/references.out"
    shell:
        """
        mlst $(dirname {input[0]})/all_complete_genomes/*.fasta | sed "s/.*\///" | sed "s/_genome\.fasta//" > {output[0]}
        """
