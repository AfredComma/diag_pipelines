rule get_protein_a_from_uniprot:
    output:
        "typing/spa_typing/references/protein_A.fasta"
    shell:
        """
        wget -qO- http://www.uniprot.org/uniprot/P02976.fasta > {output[0]}
        """

        
rule get_repeats_from_ridom:
    output:
        "typing/spa_typing/references/repeats.fasta"
    shell:
        """
        wget -qO- http://spa.ridom.de/dynamic/sparepeats.fasta > {output[0]}
        """


        
rule blast_protein_on_annotation:
    input:
        "typing/spa_typing/references/protein_A.fasta",
        "strains/{sample}/annotation/{sample}.faa",
        "strains/{sample}/annotation/{sample}.faa.phr",
    output:
        "strains/{sample}/typing/spa/spa_gene.txt"
    shell:
        """
        blastp -query {input[0]} -db {input[1]} -outfmt 6 | head -n 1 | cut -f2 > {output[0]}
        """



        
        
