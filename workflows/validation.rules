import pandas

pipeline_path = workflow.basedir + "../"

species = config["species"].replace(" ", "_")

if config["species"]=="Salmonella_enterica" or config["species"]=="Escherichia_coli":
    core="enterobase"
    enterobase = pandas.read_csv(pipeline_path + "data/core_genome_dbs/enterobase_database.tsv", sep="\t", index_col=0)
    species_taxid=int(enterobase.loc[species, "taxid"])
    ref_id=str(enterobase.loc[species, "reference_genome"])
    ref_ids_for_mapping = ref_id

else:
    core="ridom"
    ridom = pandas.read_csv(pipeline_path + "data/core_genome_dbs/ridom_database.tsv", sep="\t", index_col=0)
    species_taxid=int(ridom.loc[species, "taxid"])
    ref_id=str(ridom.loc[species, "reference_genome"])
    ref_ids_for_mapping = ref_id


include:
    "typing.rules"


rule all:
    input:
        "typing/freebayes_joint_genotyping/cgMLST/bwa/distances_in_snp_mst.svg",
        "typing/gatk_gvcfs/core_"+core+"/"+ref_id+"/bwa/distances_snp_mst.pdf",
        "typing/freebayes_joint_genotyping/core_"+core+"/"+ref_id+"/bwa/distances_snp.txt"
        
